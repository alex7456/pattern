class Student
  attr_accessor :id, :surname, :name, :patronymic, :git
  attr_reader :phone, :telegram, :email

  def initialize(**attributes)
    @errors = []
    
    attributes.each do |key, value|
      if respond_to?("#{key}=")
        begin
          send("#{key}=", value)
        rescue ArgumentError => e
          @errors << e.message
        end
      end
    end


    raise ArgumentError, @errors.join(", ") unless @errors.empty?
  end

  def set_contacts(phone: nil, email: nil, telegram: nil)
    set_phone(phone) unless phone.nil?
    set_email(email) unless email.nil?
    set_telegram(telegram) unless telegram.nil?
    validate_contact # Валидация на наличие хотя бы одного контакта
  end

  
  def validate_contact
    if phone.nil? && email.nil? && telegram.nil?
      raise ArgumentError, "Необходимо указать хоть один контакт: телефон, email или Телеграм"
    end
  end

  
  def validate_git
    if git.nil? || git.empty?
      raise ArgumentError, "Необходимо указать Github"
    end
  end

  
  def validate
    validate_contact
    validate_git
  end

  
  private

  def set_phone(value)
    if value.nil? || Student.valid_phone_number?(value)
      @phone = value
    else
      raise ArgumentError, "Недопустимый номер телефона: #{value}"
    end
  end

  def set_email(value)
    if value.nil? || Student.valid_email?(value)
      @email = value
    else
      raise ArgumentError, "Недопустимый email: #{value}"
    end
  end

  def set_telegram(value)
    if value.nil? || Student.valid_telegram?(value)
      @telegram = value
    else
      raise ArgumentError, "Недопустимый Telegram: #{value}"
    end
  end

  
  def self.valid_phone_number?(phone)
    !!(phone =~ /\A(\+?\d{1,3})?\s?\(?\d{3}\)?[\s.-]?\d{3}[\s.-]?\d{3,4}\z/)
  end

  
  def self.valid_email?(email)
    !!(email =~ /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i)
  end

  
  def self.valid_id?(id)
    id.to_s =~ /^\d+$/
  end

  
  def self.valid_name_part?(name_part)
    !!(name_part =~ /\A[А-Яа-яЁёA-Za-z]+\z/)
  end

  
  def self.valid_telegram?(telegram)
    !!(telegram =~ /\A\w+\z/)
  end

  
  def self.valid_git?(git)
    !!(git =~ /\A[\w-]+\z/)
  end
end

